# Checkpoint API + Parser - ะะพะปะฝะฐั ัะธััะตะผะฐ

ะญัะพั ัะตะปะธะท ัะพะดะตัะถะธั ะฟะพะปะฝัั ัะธััะตะผั ะดะปั ัะฑะพัะฐ ะธ ะฟัะตะดะพััะฐะฒะปะตะฝะธั ะดะฐะฝะฝัั ะพ ะฟัะฝะบัะฐั ะฟัะพะฟััะบะฐ ัะตัะตะท API.

## ๐๏ธ ะััะธัะตะบัััะฐ ัะธััะตะผั

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Python Parser โ    โ     Nginx       โ    โ   Go API        โ    โ     KeyDB       โ
โ   (Container)   โโโโโถโ   (Port 80/443) โโโโโถโ   (Port 8080)   โโโโโถโ   (Port 6379)   โ
โ   Data Collectorโ    โ   Load Balancer โ    โ   Application   โ    โ   Database      โ
โ   Every 7 min   โ    โ   Rate Limiting โ    โ   Auth & Logic  โ    โ   Persistence   โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
```

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
release/
โโโ api/                    # Go API ัะตัะฒะธั
โ   โโโ main.go            # ะัะฝะพะฒะฝะพะน ะบะพะด API
โ   โโโ go.mod             # Go ะทะฐะฒะธัะธะผะพััะธ
โ   โโโ go.sum             # Go ะทะฐะฒะธัะธะผะพััะธ (checksums)
โ   โโโ Dockerfile.prod    # Docker ะพะฑัะฐะท ะดะปั API
โ   โโโ docker-compose.prod.yml  # ะะพะฝัะธะณััะฐัะธั API + KeyDB + Nginx
โ   โโโ keydb.conf         # ะะพะฝัะธะณััะฐัะธั KeyDB
โ   โโโ nginx.prod.conf    # ะะพะฝัะธะณััะฐัะธั Nginx
โ   โโโ env.prod.example   # ะัะธะผะตั ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
โโโ parser/                # Python ะฟะฐััะตั
โ   โโโ new_checkpoint_data.py  # ะัะฝะพะฒะฝะพะน ะบะพะด ะฟะฐััะตัะฐ
โ   โโโ links.txt          # ะกะฟะธัะพะบ URL ะดะปั ะฟะฐััะธะฝะณะฐ
โ   โโโ test_keydb.py      # ะขะตัั ะฟะพะดะบะปััะตะฝะธั ะบ KeyDB
โ   โโโ requirements.txt   # Python ะทะฐะฒะธัะธะผะพััะธ
โ   โโโ Dockerfile         # Docker ะพะฑัะฐะท ะดะปั ะฟะฐััะตัะฐ
โ   โโโ docker-compose.yml # ะะพะฝัะธะณััะฐัะธั ะฟะฐััะตัะฐ + KeyDB
โโโ scripts/               # ะกะบัะธะฟัั ัะฟัะฐะฒะปะตะฝะธั
โ   โโโ deploy.sh          # ะะฐะทะฒะตัััะฒะฐะฝะธะต ัะธััะตะผั
โ   โโโ monitor.sh         # ะะพะฝะธัะพัะธะฝะณ ัะธััะตะผั
โโโ docs/                  # ะะพะบัะผะตะฝัะฐัะธั
โโโ examples/              # ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั
โโโ docker-compose.full.yml # ะะพะปะฝะฐั ะบะพะฝัะธะณััะฐัะธั ะฒัะตั ัะตัะฒะธัะพะฒ
โโโ README.md              # ะญัะพั ัะฐะนะป
```

## ๐ ะัััััะน ััะฐัั

### 1. ะะพะดะณะพัะพะฒะบะฐ

```bash
# ะะปะพะฝะธััะนัะต ะธะปะธ ัะบะฐัะฐะนัะต ัะตะปะธะท
cd release

# ะกะบะพะฟะธััะนัะต ัะฐะนะป ั ะฟะตัะตะผะตะฝะฝัะผะธ ะพะบััะถะตะฝะธั
cp api/env.prod.example .env

# ะััะตะดะฐะบัะธััะนัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
nano .env
```

### 2. ะะฐัััะพะนะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั

ะััะตะดะฐะบัะธััะนัะต `.env`:

```bash
# KeyDB Configuration
KEYDB_PASSWORD=your_very_strong_password_here

# API Authentication
AUTH_USERNAME=admin
AUTH_PASSWORD=your_very_strong_api_password_here

# Rate Limiting
RATE_LIMIT=3000
```

### 3. ะะฐะฟััะบ ะฟะพะปะฝะพะน ัะธััะตะผั

```bash
# ะกะดะตะปะฐะนัะต ัะบัะธะฟัั ะธัะฟะพะปะฝัะตะผัะผะธ (Linux/Mac)
chmod +x scripts/*.sh

# ะะฐะฟัััะธัะต ะฒัะต ัะตัะฒะธัั
./scripts/deploy.sh start
```

### 4. ะัะพะฒะตัะบะฐ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ

```bash
# ะัะพะฒะตัััะต ััะฐััั
./scripts/deploy.sh status

# ะัะพะฒะตัััะต ะทะดะพัะพะฒัะต ัะธััะตะผั
./scripts/monitor.sh health

# ะัะพะฒะตัััะต ะฟะฐััะตั
./scripts/monitor.sh parser
```

## ๐ง ะฃะฟัะฐะฒะปะตะฝะธะต ัะธััะตะผะพะน

### ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั

```bash
# ะะฐะฟััะบ ะฒัะตั ัะตัะฒะธัะพะฒ
./scripts/deploy.sh start

# ะััะฐะฝะพะฒะบะฐ ะฒัะตั ัะตัะฒะธัะพะฒ
./scripts/deploy.sh stop

# ะะตัะตะทะฐะฟััะบ ะฒัะตั ัะตัะฒะธัะพะฒ
./scripts/deploy.sh restart

# ะกัะฐััั ะฒัะตั ัะตัะฒะธัะพะฒ
./scripts/deploy.sh status

# ะะพะณะธ ะฒัะตั ัะตัะฒะธัะพะฒ
./scripts/deploy.sh logs

# ะะพะณะธ ะบะพะฝะบัะตัะฝะพะณะพ ัะตัะฒะธัะฐ
./scripts/deploy.sh logs parser
./scripts/deploy.sh logs api
./scripts/deploy.sh logs keydb
./scripts/deploy.sh logs nginx

# ะะฑะฝะพะฒะปะตะฝะธะต ะฒัะตั ัะตัะฒะธัะพะฒ
./scripts/deploy.sh update

# ะะตะทะตัะฒะฝะพะต ะบะพะฟะธัะพะฒะฐะฝะธะต
./scripts/deploy.sh backup
```

### ะะพะฝะธัะพัะธะฝะณ

```bash
# ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั
./scripts/monitor.sh health

# ะะตััะธะบะธ ัะธััะตะผั
./scripts/monitor.sh metrics

# ะัะพะฒะตัะบะฐ ะฐะปะตััะพะฒ
./scripts/monitor.sh alerts

# ะัะพะฒะตัะบะฐ ะฟะฐััะตัะฐ
./scripts/monitor.sh parser

# ะะตะฟัะตััะฒะฝัะน ะผะพะฝะธัะพัะธะฝะณ
./scripts/monitor.sh monitor
```

## ๐ API Endpoints

### ะัะฑะปะธัะฝัะต endpoints

- `GET /health` - ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั (ะฑะตะท ะฐะฒัะพัะธะทะฐัะธะธ)

### ะะฐัะธัะตะฝะฝัะต endpoints (ััะตะฑััั Basic Auth)

- `GET /api/v1/checkpoints` - ะกะฟะธัะพะบ ะฒัะตั ะฟัะฝะบัะพะฒ ะฟัะพะฟััะบะฐ
- `GET /api/v1/checkpoints/:id` - ะะฐะฝะฝัะต ะบะพะฝะบัะตัะฝะพะณะพ ะฟัะฝะบัะฐ ะฟัะพะฟััะบะฐ
- `GET /api/v1/checkpoints/ids` - ะกะฟะธัะพะบ ID ะฟัะฝะบัะพะฒ ะฟัะพะฟััะบะฐ
- `GET /api/v1/stats` - ะกัะฐัะธััะธะบะฐ

### ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

```bash
# Health check
curl http://localhost/health

# ะะพะปััะตะฝะธะต ะดะฐะฝะฝัั (ั ะฐะฒัะพัะธะทะฐัะธะตะน)
curl -u admin:your_password http://localhost/api/v1/checkpoints

# ะะพะปััะตะฝะธะต ะบะพะฝะบัะตัะฝะพะณะพ ะฟัะฝะบัะฐ ะฟัะพะฟััะบะฐ
curl -u admin:your_password http://localhost/api/v1/checkpoints/checkpoint_id

# ะะพะปััะตะฝะธะต ััะฐัะธััะธะบะธ
curl -u admin:your_password http://localhost/api/v1/stats
```

## ๐ ะะฐััะตั ะดะฐะฝะฝัั

### ะะฒัะพะผะฐัะธัะตัะบะธะน ัะตะถะธะผ
ะะฐััะตั ะฐะฒัะพะผะฐัะธัะตัะบะธ:
- ะะฐะฟััะบะฐะตััั ะฟัะธ ััะฐััะต ัะธััะตะผั
- ะะฑะฝะพะฒะปัะตั ะดะฐะฝะฝัะต ะบะฐะถะดัะต 7 ะผะธะฝัั
- ะกะพััะฐะฝัะตั ะดะฐะฝะฝัะต ะฒ KeyDB
- ะะพะณะธััะตั ัะฒะพั ัะฐะฑะพัั

### ะััะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต ะฟะฐััะตัะพะผ

```bash
# ะัะพะฒะตัะบะฐ ััะฐัััะฐ ะฟะฐััะตัะฐ
./scripts/monitor.sh parser

# ะัะพัะผะพัั ะปะพะณะพะฒ ะฟะฐััะตัะฐ
./scripts/deploy.sh logs parser

# ะะตัะตะทะฐะฟััะบ ัะพะปัะบะพ ะฟะฐััะตัะฐ
docker-compose -f docker-compose.full.yml restart parser
```

## ๐ก๏ธ ะะตะทะพะฟะฐัะฝะพััั

### ะะตะฐะปะธะทะพะฒะฐะฝะฝัะต ะผะตัั
- โ **Basic Authentication** ะดะปั API endpoints
- โ **Rate Limiting** ะฝะฐ ััะพะฒะฝะต Nginx ะธ API
- โ **Health Check** ะฑะตะท ะฐะฒัะพัะธะทะฐัะธะธ
- โ **Non-root ะฟะพะปัะทะพะฒะฐัะตะปะธ** ะฒ Docker ะบะพะฝัะตะนะฝะตัะฐั
- โ **ะกะตัะตะฒะฐั ะธะทะพะปััะธั** ัะตัะตะท Docker networks
- โ **ะะพะณะธัะพะฒะฐะฝะธะต** ะฒัะตั ะทะฐะฟัะพัะพะฒ

### ะะตะบะพะผะตะฝะดะฐัะธะธ ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ
1. **ะะทะผะตะฝะธัะต ะฟะฐัะพะปะธ** ะฒ `.env`
2. **ะะฐัััะพะธัะต HTTPS** ั SSL ัะตััะธัะธะบะฐัะฐะผะธ
3. **ะะณัะฐะฝะธัััะต ะดะพัััะฟ** ะบ ะฟะพััะฐะผ 6379 ะธ 8080
4. **ะะฐัััะพะนัะต ัะฐะนัะฒะพะป**
5. **ะะตะณัะปััะฝะพ ะพะฑะฝะพะฒะปัะนัะต** Docker ะพะฑัะฐะทั

## ๐ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

### ะะถะธะดะฐะตะผะฐั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั
- **Rate Limit**: 3000 ะทะฐะฟัะพัะพะฒ/ะผะธะฝััั
- **Response Time**: < 100ms ะดะปั health check
- **Memory Usage**: ~200MB ะดะปั API, ~100MB ะดะปั KeyDB, ~150MB ะดะปั ะฟะฐััะตัะฐ
- **CPU Usage**: < 10% ะฒ ะพะฑััะฝะพะผ ัะตะถะธะผะต
- **Data Update**: ะบะฐะถะดัะต 7 ะผะธะฝัั

## ๐ ะะพะฝะธัะพัะธะฝะณ ะธ ะปะพะณะธัะพะฒะฐะฝะธะต

### ะะพัััะฟะฝัะต ะผะตััะธะบะธ
- โ **Health Status** - ััะฐััั ะฒัะตั ัะตัะฒะธัะพะฒ
- โ **Resource Usage** - CPU, ะฟะฐะผััั, ัะตัั
- โ **KeyDB Metrics** - ะฟะฐะผััั, ะบะปะธะตะฝัั, ะพะฟะตัะฐัะธะธ
- โ **API Response Times** - ะฒัะตะผั ะพัะฒะตัะฐ endpoints
- โ **Parser Status** - ััะฐััั ะฟะฐััะตัะฐ ะธ ะบะพะปะธัะตััะฒะพ ะดะฐะฝะฝัั
- โ **Error Rates** - ะบะพะปะธัะตััะฒะพ ะพัะธะฑะพะบ

### ะะพะณะธ
```bash
# ะัะต ัะตัะฒะธัั
./scripts/deploy.sh logs

# ะะพะฝะบัะตัะฝัะน ัะตัะฒะธั
./scripts/deploy.sh logs api
./scripts/deploy.sh logs parser
./scripts/deploy.sh logs keydb
./scripts/deploy.sh logs nginx
```

## ๐จ ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะงะฐัััะต ะฟัะพะฑะปะตะผั

1. **ะกะตัะฒะธัั ะฝะต ะทะฐะฟััะบะฐัััั**
   ```bash
   # ะัะพะฒะตัััะต ะปะพะณะธ
   ./scripts/deploy.sh logs
   
   # ะัะพะฒะตัััะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
   cat .env
   ```

2. **API ะฝะต ะพัะฒะตัะฐะตั**
   ```bash
   # ะัะพะฒะตัััะต ะทะดะพัะพะฒัะต
   ./scripts/monitor.sh health
   
   # ะัะพะฒะตัััะต ะฟะพะดะบะปััะตะฝะธะต ะบ KeyDB
   docker-compose -f docker-compose.full.yml exec keydb keydb-cli ping
   ```

3. **ะะฐััะตั ะฝะต ัะฐะฑะพัะฐะตั**
   ```bash
   # ะัะพะฒะตัััะต ะฟะฐััะตั
   ./scripts/monitor.sh parser
   
   # ะัะพะฒะตัััะต ะปะพะณะธ ะฟะฐััะตัะฐ
   ./scripts/deploy.sh logs parser
   ```

4. **ะััะพะบะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ัะตััััะพะฒ**
   ```bash
   # ะัะพะฒะตัััะต ะผะตััะธะบะธ
   ./scripts/monitor.sh metrics
   
   # ะัะพะฒะตัััะต ะฐะปะตััั
   ./scripts/monitor.sh alerts
   ```

## ๐ ะะฑะฝะพะฒะปะตะฝะธะต

### ะะฑะฝะพะฒะปะตะฝะธะต ัะธััะตะผั

```bash
# ะััะฐะฝะพะฒะธัะต ัะตัะฒะธัั
./scripts/deploy.sh stop

# ะะฑะฝะพะฒะธัะต ะบะพะด
git pull  # ะธะปะธ ะทะฐะผะตะฝะธัะต ัะฐะนะปั

# ะะตัะตัะพะฑะตัะธัะต ะธ ะทะฐะฟัััะธัะต
./scripts/deploy.sh update
```

### ะะฑะฝะพะฒะปะตะฝะธะต Docker ะพะฑัะฐะทะพะฒ

```bash
# ะะฑะฝะพะฒะธัะต ะฒัะต ะพะฑัะฐะทั
docker-compose -f docker-compose.full.yml pull

# ะะตัะตะทะฐะฟัััะธัะต ั ะฝะพะฒัะผะธ ะพะฑัะฐะทะฐะผะธ
./scripts/deploy.sh restart
```

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั

- `docs/API.md` - ะะพะดัะพะฑะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั API
- `docs/PARSER.md` - ะะพะบัะผะตะฝัะฐัะธั ะฟะฐััะตัะฐ
- `docs/DEPLOYMENT.md` - ะะฝััััะบัะธะธ ะฟะพ ัะฐะทะฒะตัััะฒะฐะฝะธั
- `examples/` - ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั API

## ๐ฏ ะะฐะบะปััะตะฝะธะต

ะญัะฐ ัะธััะตะผะฐ ะฟัะตะดะพััะฐะฒะปัะตั:
- โ **ะะฒัะพะผะฐัะธัะตัะบะธะน ัะฑะพั ะดะฐะฝะฝัั** ะพ ะฟัะฝะบัะฐั ะฟัะพะฟััะบะฐ
- โ **REST API** ะดะปั ะดะพัััะฟะฐ ะบ ะดะฐะฝะฝัะผ
- โ **ะััะพะบัั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั** ะธ ะฝะฐะดะตะถะฝะพััั
- โ **ะัะพััะพะต ัะฐะทะฒะตัััะฒะฐะฝะธะต** ัะตัะตะท Docker
- โ **ะะพะฝะธัะพัะธะฝะณ ะธ ะปะพะณะธัะพะฒะฐะฝะธะต**
- โ **ะะตะทะพะฟะฐัะฝะพััั** ะธ ะฐััะตะฝัะธัะธะบะฐัะธั

**ะกะธััะตะผะฐ ะณะพัะพะฒะฐ ะบ ะฟัะพะดะฐะบัะตะฝั!** ๐


